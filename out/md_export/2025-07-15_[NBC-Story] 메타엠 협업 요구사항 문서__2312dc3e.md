---
created_date: 2025-07-15
id: 2312dc3e-f514-80b2-a1f6-e8ff3e4aca1a
url: https://www.notion.so/NBC-Story-2312dc3ef51480b2a1f6e8ff3e4aca1a
perf_flag: yes
importance: 5
summary_5lines:
  - 실험 결과 요약 (Result Summary)
  - 실험 설계 관점에서 얻은 교훈과 고객 행동 인사이트를 간단히 요약하고 다음과 같이 연결합니다
  - 정량 데이터 기반 변화량 정리 (전환율, 클릭률 등)
  - 2) 퍼널 상태 변경 (메타엠에서 적어주시면 될 내용)
  - 배운 점을 기반으로 어떤 추가 기회를 실험해볼 것인가?
---

# 2025-07-15_[NBC-Story] 메타엠 협업 요구사항 문서

| Property | Value |
| --- | --- |
| created_date | 2025-07-15 |
| id | 2312dc3e-f514-80b2-a1f6-e8ff3e4aca1a |
| url | https://www.notion.so/NBC-Story-2312dc3ef51480b2a1f6e8ff3e4aca1a |
| perf_flag | yes |
| importance | 5 |
| summary_5lines | |
|  | - 실험 결과 요약 (Result Summary) |
|  | - 실험 설계 관점에서 얻은 교훈과 고객 행동 인사이트를 간단히 요약하고 다음과 같이 연결합니다 |
|  | - 정량 데이터 기반 변화량 정리 (전환율, 클릭률 등) |
|  | - 2) 퍼널 상태 변경 (메타엠에서 적어주시면 될 내용) |
|  | - 배운 점을 기반으로 어떤 추가 기회를 실험해볼 것인가? |

Original: https://www.notion.so/NBC-Story-2312dc3ef51480b2a1f6e8ff3e4aca1a

# **SOLUTION DESIGN (해결방안 설계)**

## 1. 프로젝트 목적
- **상담 자동화 및 세일즈 BAU화**를 위한 MetaM 솔루션과 팀스파르타 백오피스 간 **데이터 연동 체계 구축**
- 주요 목표:
  - 리드 생성 → 상담사 배정 → 콜 진행 → 상담 결과 기록 → STT 요약 → 백오피스 반영까지 전체 자동화 플로우 구성
  - 메타엠 DB와 팀스파르타 백오피스 간 실시간/비동기 데이터 연동

---

## 2. 전체 연동 흐름
```javascript
팀스파르타 백오피스 → MetaM DB → MetaM 상담사 화면
                                 ↓
팀스파르타 백오피스 ← 상담기록 / 콜로그 / STT / 퍼널 변경 Webhook
```

## 1. 용어 정리

  ---

### 워크스페이스(workspace)
| 요소 | 관계 | 설명 |
| --- | --- | --- |
| 리드 | 1:N | 하나의 워크스페이스는 여러 리드를 **포함된다.** |
| 퍼널 | 1:N | 하나의 워크스페이스는 여러 개의 퍼널을 관리 한다. |
| 세일즈 담당자 | N:M | 세일즈 담당자들은 여러 워크스페이스에서 활동 가능하다. |
  - 설명
    - 워크스페이스는 팀스파르타의 제품별 격리공간을 의미한다.
    - **팀스파르타 워크스페이스는 MetaM의 캠페인과 같은 위계이다.**
  - 팀스파르타 ↔ MetaM
    - 워크스페이스 생성
    - 워크스페이스 퍼널 변경

### 리드(lead)
| 요소 | 관계 | 설명 |
| --- | --- | --- |
| 워크스페이스 | N:1 | 리드는 **반드시 하나의** 워크스페이스에 소속된다 |
| 퍼널 | N:1 | 리드는 특정 시점에 **반드시 하나의** 퍼널의 할당된다. |
| 세일즈 담당자 | N:1 | 리드는 **하나의** 세일즈 담당자에게 할당된다. |
  - 설명
    - 팀스파르타에서 생성된 세일즈 대상 잠재고객 정보를 의미한다.
    - 리드는 속해있는 워크스페이스에서 정의된 퍼널 상태중 하나를 갖는다.
  - 팀스파르타 ↔ MetaM 
    - 리드 생성
    - 세일즈 담당자 변경
    - 리드 퍼널 변경 & 전화 상담 기록 = MetaM 상담 완료

### 세일즈 담당자(salesman)
| 요소 | 관계 | 설명 |
| --- | --- | --- |
| 리드 | 1 : N | 세일즈 담당자는 여러 리드를 관리한다. |
| 워크스페이스 | N:M | 세일즈 담당자들은 여러 워크스페이스에 소속 될 수 있다. |
  - 설명
    - 세일즈 담당자는 리드를 할당받아 잠재고객에게 세일즈 활동 담당자를 의미한다.
  - 팀스파르타 ↔ MetaM
    - 세일즈 담당자 생성 / 삭제
    - 세일즈 담당자 소속 워크스페이스 변경

## 2. API 명세

  ---

### 인증 헤더
  ```typescript
  Content-Type: application/json
  Authorization: Bearer <api-secret-key>
  ```
  - ▶ api-secret-key (유출주의)
    ```typescript
    "api-secret-key" : "4aaa2da1-8132-46b7-9ba2-8571dad6218f"
    ```

### URL
  - 팀스파르타
    - 테스트 https://[api.testnbc.spartacodingclub.kr](http://api.testnbc.spartacodingclub.kr/)
    - 운영 : https://[api.nbc.spartacodingclub.kr](http://api.testnbc.spartacodingclub.kr/)
  - MetaM
    - 테스트 :
    - 운영 :

### 참고
  - 이벤트 타입은 {객체}.{속성}.{행위} 형태를 따른다
  - url 에 행위를 드러내고 POST 메서드를 사용한다
  - 요청 방향
    - Client는 요청을 보내는쪽 / Server 는 요청을 받는 쪽을 의미한다
    - inbound / outbound 는 팀스파르타 기준으로 정의한다
    - Inbound : Server(팀스파르타) - Client(MetaM)
    - outbound: Server(MetaM) - Client(팀스파르타)

  - ▶ legacy
    - ▶ 연동 플로우 (접어 놓았습니다.)

## API 사양 

### **3. 연동 흐름 상세 (Flow & API Overview)**
| **순서** | **기능 명** | **처리 방향** | **주요 데이터** | **전달 방식** | **비고** |
| --- | --- | --- | --- | --- | --- |
| 1 | 리드 생성 | 팀스파르타 → MetaM | 기본정보 + 퍼널 + workspace_id | POST /leads | 업무시간 중 5~10분 주기 or 일괄 전송 |
| 2 | 리드 조회 | MetaM → 팀스파르타 | 리드 상세정보 | GET /leads/:id | 상세 페이지 링크 포함 |
| 3 | 상담 기록 | MetaM → 팀스파르타 | 상담 요약 + 생성일자 + 상담자 | GET ??? |  |
| 4 | 퍼널 상태 변경 | MetaM → 팀스파르타 | prev_funnel → current_funnel | GET ???  |  |
| 5 | STT 결과 | MetaM → 팀스파르타 | 원문 + 요약 + timestamp | GET ???  |  |
| 6 | 인증 / 보안 | 양방향 | Bearer Token or IP 제한 | 헤더 방식 | 사전 키 발급 필요 |

---

## **4. 데이터 필드 정의**

### **📤 팀스파르타 → MetaM 전달 데이터 (신규 리드)**
```plain text
{
  "lead_id": "uuid",
  "phone": "01091134451",
  "user_name": "홍길동",
  "birth": "19921012",
  "sales_funnel": "PENDING",
  "creation_context": "서류 합격",
  "email": "hong@spartacodingclub.kr",
  "applicant_id": "682298890a72040b803ef258",
  "workspace_id": "nbcamp-kdt-uxui-08"
}
```

### **📥 MetaM → 팀스파르타 전달 데이터**

### **1) 콜로그 기록 (메타엠에서 적어주시면 될 내용)**
```plain text
{
  "lead_id": "uuid",
  "content": "상담 내용 요약",
  "created_at": "2025-07-15T10:00:00Z",
  "manager": {
    "name": "김매니저",
    "email": "manager@metam.io"
  }
}
```

### **2) 퍼널 상태 변경 (메타엠에서 적어주시면 될 내용)**
```plain text
{
  "lead_id": "uuid",
  "prev_funnel": "IN_SALES",
  "current_funnel": "CARD_APPLIED",
  "manager": {
    "name": "김매니저",
    "email": "manager@metam.io"
  }
}
```

### **3) STT 요약 전달 (메타엠에서 적어주시면 될 내용)**
```plain text
{
  "lead_id": "uuid",
  "converted_text": "고객이 부트캠프 일정 문의",
  "ai_summary": "UXUI 관심, 카드발급 희망",
  "created_at": "2025-07-15T10:30:00Z"
}
```

---

## **5. 퍼널 상태 정의 (Enum) - 워크스페이스별로 다를 예정**
```plain text
enum FunnelCode {
  PENDING = "PENDING",          // 생성만 됨, 배정 전
  STARTED = "STARTED",          // 배정 완료, 상담 대기
  COMPLETED = "COMPLETED",      // 세일즈 전환 완료
  LOST = "LOST"                 // 세일즈 탈락 or 철회
}
```

---

## **6. 보안 / 인증 방식**
- 인증 방식: **Bearer Token** or **API Key 방식**

---

## **7. 사전 합의 및 특이사항**
- workspace_id는 팀스파르타 내부 기준이며, **MetaM 캠페인 ID와 매핑 구조 필요**
- 메타엠 플랫폼 내에서 세일즈 리드에 대한 매니저 배정을 진행

---

## **🔗 담당자**
| **구분** | **이름** |
| --- | --- |
| 팀스파르타 PM | 이승수 |
| 팀스파르타 개발 | 박현우 |

---
※ 해당 문서는 연동 합의 및 API 스펙서 작성 전 **사전 협업 정의 문서**입니다. 변경 또는 제안 사항은 상호 간 조율 바랍니다. 주 소통은 슬랙에서 이뤄집니다! 

### [사전 정책 공유]
@mention 
- 모든 세일즈 리드는 다음 기준을 따라 정의됨
  - 워크스페이스별 퍼널 정의: started, completed, lost 등 기본값 + 커스텀 단계
  - 각 퍼널 상태에서 리드의 주요 행동 및 전환 조건 정의 필요

---

### **API 설계 흐름 (Flow & Response)**

### Task 모음집

# **PRD (Product Requirements Document)**

### **요구 기능 요약 (Core Features)**

### **QA 체크리스트**

# [4] Review & Learning

### 실험 결과 요약 (Result Summary)
- **Before → After 지표 변화**:
  - 정량 데이터 기반 변화량 정리 (전환율, 클릭률 등)
  - 
- **고객 반응 및 VOC 요약**:
  - 인터뷰/설문/채팅 기반 주요 피드백 정리
  - 

### 학습 정리 및 인사이트 (Key Learnings)
- 이번 실험 결과를 기반으로 다음 실험을 어떻게 설계할 수 있을지에 초점을 맞춥니다.
- 실험 설계 관점에서 얻은 교훈과 고객 행동 인사이트를 간단히 요약하고 다음과 같이 연결합니다
- 고객의 행동 변화로부터 무엇을 도출할 수 있었는가?
  - 
- 배운 점을 기반으로 어떤 추가 기회를 실험해볼 것인가?
  -

## Databases

### Database: 24f2dc3e-f514-80dc-a8fd-d945c3c43654

| API 상세 | Client | METHOD | Server | URL | 도메인 | 설명 | 완료 | 이벤트 타입 | notion_url |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| API 명세 상세 | 팀스파르타 | POST | MetaM | event/salesman/workspace/changed | salesman | 팀스파르타 세일즈 백오피스에서 세일즈 담당자의 소속 워크스페이스 변경시 요청하여 MetaM 콘솔에 세일즈 담당자 정보 변경 | false | salesman.workspace.changed | https://www.notion.so/API-2542dc3ef514802b9a05e7c51218ddb9 |
| API 명세 상세 | 팀스파르타 | POST | MetaM | event/workspace/created | workspace | 팀스파르타 세일즈 백오피스에서 새로운 워크스페이스 생성시 요청하여 MetaM 콘솔에 캠페인 생성 | false | workspace.created | https://www.notion.so/API-24f2dc3ef51481ddaa9be100e96699e5 |
| API 명세 상세 | 팀스파르타 | POST | MetaM | event/workspace/funnel/changed | workspace | 팀스파르타 워크스페이스의 퍼널 정보가 변동시  요청하여
MetaM 콘솔에 퍼널을 변경 | false | workspace.funnel.changed | https://www.notion.so/API-24f2dc3ef514819388efe41543ceb600 |
| API 명세 상세 | MetaM | POST | 팀스파르타 | event/lead/call/transcription/created | lead | MetaM 콘솔에서 상담이 완료되고, 통화 기록(STT) 및 세일즈 퍼널 변경 데이터를 업데이트한다. | false | lead.call.transcription.created | https://www.notion.so/API-24f2dc3ef51481b39354f7f4059a8145 |
| API 명세 상세 | MetaM | POST | 팀스파르타 | event/lead/salesman/changed | lead | MetaM 콘솔에서 리드의 세일즈 담당자가 변경되면 요청하여 팀스파르타 세일즈 백오피스 리드의 세일즈 담당자를 변경한다. | false | lead.salesman.changed | https://www.notion.so/API-24f2dc3ef51481948eabffd87caff072 |
| API 명세 상세 | 팀스파르타 | POST | MetaM | event/lead/salesman/allocated | lead | 팀스파르타에서 리드에 세일즈 담당자를 배정시 요청하여
MetaM 콘솔에 리드를 생성 | false | lead.salesman.allocated | https://www.notion.so/API-24f2dc3ef51481ce8510f057ec4026ce |
