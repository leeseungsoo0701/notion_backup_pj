---
created_date: 2024-04-02
id: 2ef38f7c-90cc-455a-b7f1-3394ce176f37
url: https://www.notion.so/D-7-2ef38f7c90cc455ab7f13394ce176f37
perf_flag: yes
importance: 4
summary_5lines:
  - --나이가 18세 이하 또는 37세 이상 제외
  - -- 완주 후 설문 updated 시간 기준  1일 전 d+1
  - 나이 타겟: 18~38세
  - 완주 D+7 19시 발송
  - 최근 14일 내일배움캠프 미지원자
---

# 2024-04-02_유료/국비과목 완주 D+7

| Property | Value |
| --- | --- |
| created_date | 2024-04-02 |
| id | 2ef38f7c-90cc-455a-b7f1-3394ce176f37 |
| url | https://www.notion.so/D-7-2ef38f7c90cc455ab7f13394ce176f37 |
| perf_flag | yes |
| importance | 4 |
| summary_5lines | |
|  | - --나이가 18세 이하 또는 37세 이상 제외 |
|  | - -- 완주 후 설문 updated 시간 기준  1일 전 d+1 |
|  | - 나이 타겟: 18~38세 |
|  | - 완주 D+7 19시 발송 |
|  | - 최근 14일 내일배움캠프 미지원자 |

Original: https://www.notion.so/D-7-2ef38f7c90cc455ab7f13394ce176f37

### 발송 대상
- 강의명: 유료/KDC 강의 완주자 
- 나이 타겟: 18~38세
- 마케팅 수신 동의자
- 내일배움캠프 미결제자
- 최근 14일 내일배움캠프 미지원자

### 발송 시점
- 완주 D+7 19시 발송

### 발송 모수 쿼리
```sql
-- 유료강의들
WITH trial_courses AS (
    SELECT c._id, c.title, c._id as course_id, r._id as round_id 
    FROM dbonline_v2_courses c
    LEFT JOIN dbonline_v2_rounds AS r
    ON c._id = r.course_id 
    WHERE r.is_hanghae is not true -- 항해 지급 과목 제외
    AND r.is_gov_training is not true -- 내배캠 지급 과목 제외 
    AND c.is_trial is not true -- 무료 강의 제외
    and c.is_b2g2b is not true -- b2b에서 지급한 강의 제외
    and c.is_developer_trial is not true 
    and r.course_id is not null -- 기수테이블에 존재하지 않는 과목 제외 
    ORDER BY r.created_at desc
),
-- 회원
users AS (
        SELECT name, _id, marketing, phone, birthyear
        FROM dbonline_v2_users
),

-- 완주 후 설문
enrolleds_finish_survey AS (
    SELECT enrolled_id, updated_at, text_log
    FROM dbonline_v2_enrolleds_finish_survey
)


-- crm_template_code 넣어줘야함
SELECT 
    DISTINCT 
    u.phone, 
    u.name as user_name, 
    c.title as course_title,
    birthyear,
    efs.updated_at
    , DATEDIFF(day, efs.updated_at, GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Asia/Seoul')
    ,  GETDATE() AT TIME ZONE 'UTC' AT TIME ZONE 'Asia/Seoul' as times 
FROM dbonline_v2_enrolleds e
INNER JOIN trial_courses c 
    ON e.course_id = c._id and e.round_id = c.round_id
INNER JOIN users u
    ON u._id = e.user_id 
-- 완주자 중 마지막 설문을 작성
INNER JOIN enrolleds_finish_survey efs
    ON efs.enrolled_id = e._id
WHERE __hevo__marked_deleted = FALSE
-- 완주 후 설문 updated 시간 기준  1일 전 d+1
AND u._id not in (select nb.user.onlineUserId FROM dbnbcamp_applicants nb)

-- 마케팅 수신 동의 안한 유저 제외 
AND u.marketing is not false

--나이가 18세 이하 또는 37세 이상 제외
AND birthyear between 1988 and 2005

ORDER BY e.created_at DESC;
```

---

### 제목
```plain text
스파르타 완주자 대상 국비지원 안내
```

### 본문
```plain text
스파르타코딩클럽과 함께 완주를 경험한 #{user_name} 님!
#{course_title} 과목을 배운 것을 토대로 IT 취업까지 도전해보시면 어떨까요?
58만명의 수강생을 배출한 스파르타코딩클럽에서 진행하는 국비지원 부트캠프로 시작하세요!

[스파르타 국비지원 부트캠프]
■ 2,000만원 상당의 교육비 전액 국비지원
■ 상주 튜터와 수준별 맞춤 분반 학습
■ 1,000여개의 협력사, 기간 제한 없는 취업지원 

[더 알아보기]
https://nbcamp.spartacodingclub.kr/

※ 현재 지원자가 많아, 조기 모집 마감 될 수 있습니다.
```

### 변수 정리
| 변수명 | 변수에 들어갈 내용 | 변수 예시 |
| --- | --- | --- |
| #{name} | 수강생 이름 | 이승수 |
| #{course_title} | 강의명 | 게임개발 종합반 |

### 결과값 예시
```javascript
스파르타코딩클럽과 함께 완주를 경험한 이승수 님!
게임개발 종합반 과목을 배운 것을 토대로 IT 취업까지 도전해보시면 어떨까요?
58만명의 수강생을 배출한 스파르타코딩클럽에서 진행하는 국비지원 부트캠프로 시작하세요!

[스파르타 국비지원 부트캠프]
■ 2,000만원 상당의 교육비 전액 국비지원
■ 상주 튜터와 수준별 맞춤 분반 학습
■ 1,000여개의 협력사, 기간 제한 없는 취업지원 

[더 알아보기]
https://nbcamp.spartacodingclub.kr/

※ 현재 지원자가 많아, 조기 모집 마감 될 수 있습니다.
```
